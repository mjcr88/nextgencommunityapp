# Ecovilla Community Platform - Fullstack Architecture Document

## Table of Contents

- [Ecovilla Community Platform - Fullstack Architecture Document](#table-of-contents)
  - [Introduction](./introduction.md)
    - [Change Log](./introduction.md#change-log)
    - [Starter Template Decision](./introduction.md#starter-template-decision)
  - [High Level Architecture](./high-level-architecture.md)
    - [Technical Summary](./high-level-architecture.md#technical-summary)
    - [Platform and Infrastructure Choice](./high-level-architecture.md#platform-and-infrastructure-choice)
    - [Repository Structure](./high-level-architecture.md#repository-structure)
    - [High Level Architecture Diagram](./high-level-architecture.md#high-level-architecture-diagram)
    - [Architectural Patterns](./high-level-architecture.md#architectural-patterns)
  - [Tech Stack](./tech-stack.md)
  - [Data Models](./data-models.md)
    - [Overview](./data-models.md#overview)
    - [Domain 1: Tenant & User Management](./data-models.md#domain-1-tenant-user-management)
      - [1.1 Tenant](./data-models.md#11-tenant)
      - [1.2 User](./data-models.md#12-user)
      - [1.3 UserConnection (NEW)](./data-models.md#13-userconnection-new)
    - [Domain 2: Location & Community](./data-models.md#domain-2-location-community)
      - [2.1 Location](./data-models.md#21-location)
      - [2.2 CheckIn](./data-models.md#22-checkin)
    - [Domain 3: Events](./data-models.md#domain-3-events)
      - [3.1 Event](./data-models.md#31-event)
      - [3.2 RSVP](./data-models.md#32-rsvp)
    - [Domain 4: Exchange](./data-models.md#domain-4-exchange)
      - [4.1 Listing](./data-models.md#41-listing)
      - [4.2 ListingRequest](./data-models.md#42-listingrequest)
      - [4.3 ListingTransaction](./data-models.md#43-listingtransaction)
    - [Domain 5: Service Requests](./data-models.md#domain-5-service-requests)
      - [5.1 ServiceRequest](./data-models.md#51-servicerequest)
    - [Domain 6: Content & Summaries (n8n Integration Output)](./data-models.md#domain-6-content-summaries-n8n-integration-output)
      - [6.1 ContentSummary](./data-models.md#61-contentsummary)
      - [6.2 ContentEmbedding](./data-models.md#62-contentembedding)
    - [Domain 7: AI & System](./data-models.md#domain-7-ai-system)
      - [7.1 AIChatSession](./data-models.md#71-aichatsession)
      - [7.2 AIChatMessage](./data-models.md#72-aichatmessage)
      - [7.3 OptionSet](./data-models.md#73-optionset)
      - [7.4 Notification](./data-models.md#74-notification)
      - [7.5 ActivityFeedItem](./data-models.md#75-activityfeeditem)
      - [7.6 AdminMetric](./data-models.md#76-adminmetric)
  - [Data Model Diagram](./data-model-diagram.md)
  - [API Specification (Server Actions & API Routes)](./api-specification-server-actions-api-routes.md)
    - [Domain 1: Tenant & User Management](./api-specification-server-actions-api-routes.md#domain-1-tenant-user-management)
    - [Domain 2: Location & Community](./api-specification-server-actions-api-routes.md#domain-2-location-community)
    - [Domain 3: Events](./api-specification-server-actions-api-routes.md#domain-3-events)
    - [Domain 4: Exchange](./api-specification-server-actions-api-routes.md#domain-4-exchange)
    - [Domain 5: Service Requests](./api-specification-server-actions-api-routes.md#domain-5-service-requests)
    - [Domain 6: Content & Summaries (n8n Output)](./api-specification-server-actions-api-routes.md#domain-6-content-summaries-n8n-output)
    - [Domain 7: AI & System](./api-specification-server-actions-api-routes.md#domain-7-ai-system)
  - [Security and Performance (Hardening Strategy)](./security-and-performance-hardening-strategy.md)
    - [1. Input Validation (Zod)](./security-and-performance-hardening-strategy.md#1-input-validation-zod)
    - [2. CSRF Protection (Server Actions)](./security-and-performance-hardening-strategy.md#2-csrf-protection-server-actions)
    - [3. API Key Management (External Services)](./security-and-performance-hardening-strategy.md#3-api-key-management-external-services)
    - [4. Rate Limiting (Vercel KV/Redis)](./security-and-performance-hardening-strategy.md#4-rate-limiting-vercel-kvredis)
  - [Testing Strategy](./testing-strategy.md)
    - [1. Unit Testing (Vitest)](./testing-strategy.md#1-unit-testing-vitest)
    - [2. Integration Testing (Vitest + Supabase Mocking)](./testing-strategy.md#2-integration-testing-vitest-supabase-mocking)
    - [3. End-to-End (E2E) Testing (Playwright)](./testing-strategy.md#3-end-to-end-e2e-testing-playwright)
    - [4. Workflow Testing (n8n)](./testing-strategy.md#4-workflow-testing-n8n)
  - [Deployment Architecture](./deployment-architecture.md)
    - [1. CI/CD Pipeline (GitHub Actions)](./deployment-architecture.md#1-cicd-pipeline-github-actions)
    - [2. n8n Hosting Strategy (Self-Hosted, Scheduled)](./deployment-architecture.md#2-n8n-hosting-strategy-self-hosted-scheduled)
    - [3. Environment Management](./deployment-architecture.md#3-environment-management)
  - [Error Handling Strategy](./error-handling-strategy.md)
    - [1. Global Error Handling Pattern](./error-handling-strategy.md#1-global-error-handling-pattern)
    - [2. External API Retry Mechanisms](./error-handling-strategy.md#2-external-api-retry-mechanisms)
    - [3. Database Error Handling](./error-handling-strategy.md#3-database-error-handling)
  - [Monitoring and Observability](./monitoring-and-observability.md)
    - [1. Application Performance Monitoring (APM)](./monitoring-and-observability.md#1-application-performance-monitoring-apm)
    - [2. Logging Strategy](./monitoring-and-observability.md#2-logging-strategy)
    - [3. Cost Tracking and Optimization](./monitoring-and-observability.md#3-cost-tracking-and-optimization)
  - [Implementation Architecture](./implementation-architecture.md)
    - [1. External API Integration Contracts](./implementation-architecture.md#1-external-api-integration-contracts)
      - [OpenAI API Integration](./implementation-architecture.md#openai-api-integration)
      - [Telegram Bot API Integration](./implementation-architecture.md#telegram-bot-api-integration)
    - [2. Frontend Architecture](./implementation-architecture.md#2-frontend-architecture)
      - [Component Architecture & State Management](./implementation-architecture.md#component-architecture-state-management)
      - [Routing & Data Fetching](./implementation-architecture.md#routing-data-fetching)
    - [3. Unified Project Structure](./implementation-architecture.md#3-unified-project-structure)
  - [Next Steps](./next-steps.md)
